# üå°Ô∏è Zabbix Advanced CPU Temperature (Python/Sysfs)

![Zabbix 7.0+](https://img.shields.io/badge/Zabbix-7.0%2B-blue) ![Python 3](https://img.shields.io/badge/Python-3.x-yellow) ![Method Sysfs](https://img.shields.io/badge/Method-Direct_Sysfs-green) ![License](https://img.shields.io/badge/License-MIT-grey)

–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –≤ Zabbix.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç** –ø–∞—Ä—Å–∏–Ω–≥ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã `sensors` (lm-sensors). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Python-—Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä—è–º–æ–≥–æ —á—Ç–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —è–¥—Ä–∞ Linux (`/sys/class/hwmon`), —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –∑–∞–ø—É—Å–∫ –æ–±–æ–ª–æ—á–∫–∏ (shell) –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–µ—Ä—Å–∏–π —É—Ç–∏–ª–∏—Ç.

### üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
* **Auto-Discovery (LLD):** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —è–¥—Ä–∞ CPU –∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã.
* **Smart Detection:** –°–∫—Ä–∏–ø—Ç —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –Ω—É–∂–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä (`coretemp` –¥–ª—è Intel, `k10temp`/`zenpower` –¥–ª—è AMD).
* **–ú–µ—Ç—Ä–∏–∫–∏:** –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–∞–∂–¥–æ–≥–æ —è–¥—Ä–∞ + –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Min / Max / Avg –ø–æ –≤—Å–µ–º —è–¥—Ä–∞–º).
* **–ì—Ä–∞—Ñ–∏–∫–∏:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —è–¥—Ä–∞ –∏ —Å–≤–æ–¥–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞.
* **Zabbix 7.4 Ready:** –®–∞–±–ª–æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ Zabbix (UUIDv4 compliant).

---

## üß† –õ–æ–≥–∏–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ (Best Practices)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ¬´–í–æ—Ä–æ–Ω–∫–∏¬ª (Funnel Strategy). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã (Turbo Boost / –∫–æ–º–ø–∏–ª—è—Ü–∏—è) –∏ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ–º.

| –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ | –ó–∞–¥–µ—Ä–∂–∫–∞ | –£—Ä–æ–≤–µ–Ω—å | –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã |
| :--- | :--- | :--- | :--- |
| **> 70¬∞C** | 30 –º–∏–Ω | `Info` | –•—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è –≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞. –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ —Å—Ç–æ–∏—Ç –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ. |
| **> 80¬∞C** | 10 –º–∏–Ω | `Warning` | –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–µ. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –Ω–µ –ø–∞–¥–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è. |
| **> 90¬∞C** | 3 –º–∏–Ω | `Average` | **–ü–µ—Ä–µ–≥—Ä–µ–≤.** –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ –Ω–µ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —Ç–µ–ø–ª–æ–æ—Ç–≤–æ–¥–æ–º. –†–∏—Å–∫ —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥–∞. |
| **> 95¬∞C** | 1 –º–∏–Ω | `High` | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞. –ë–ª–∏–∑–∫–æ –∫ T-Junction max. |
| **> 100¬∞C** | 0 –º–∏–Ω | `Disaster` | –ê–≤–∞—Ä–∏–π–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è. –†–∏—Å–∫ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞. |

---

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. Python –°–∫—Ä–∏–ø—Ç
–°–∫—Ä–∏–ø—Ç –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ–º —è–¥–µ—Ä –∏ —á—Ç–µ–Ω–∏–µ–º —Ñ–∞–π–ª–æ–≤ sysfs.

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ (–µ—Å–ª–∏ –µ—ë –Ω–µ—Ç):
   ```bash
   sudo mkdir -p /etc/zabbix/scripts


2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `zbx_py_cputemp.py` –∏–∑ —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ `/etc/zabbix/scripts/`.
3. –î–∞–π—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
```bash
sudo chmod +x /etc/zabbix/scripts/zbx_py_cputemp.py

```



### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Zabbix Agent

–ù–∞–º –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ–≥–æ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É `UserParameter`. –í–µ—Å—å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ Python-—Å–∫—Ä–∏–ø—Ç–∞.

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥–∞ `/etc/zabbix/zabbix_agent2.d/python_cputemp.conf`:
```ini
UserParameter=py.cputemp[*],/etc/zabbix/scripts/zbx_py_cputemp.py $1 $2

```


2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≥–µ–Ω—Ç:
```bash
# –î–ª—è Zabbix Agent 2
sudo systemctl restart zabbix-agent2

# –ò–ª–∏ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
sudo systemctl restart zabbix-agent

```



### 3. –ò–º–ø–æ—Ä—Ç —à–∞–±–ª–æ–Ω–∞

1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª `template_cputemp.yaml`.
2. –í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ Zabbix –ø–µ—Ä–µ–π–¥–∏—Ç–µ: **Data collection** ‚Üí **Templates** ‚Üí **Import**.
3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ —à–∞–±–ª–æ–Ω –∫ –Ω—É–∂–Ω–æ–º—É —Ö–æ—Å—Ç—É.

---

## ‚ùì Troubleshooting

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–∂–Ω–æ –ø—Ä—è–º–æ –∏–∑ –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è JSON)
zabbix_agent2 -t py.cputemp[discovery]

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
zabbix_agent2 -t py.cputemp[avg]

```

–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `zabbix` –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —á—Ç–µ–Ω–∏—é `/sys/class/hwmon/*` (–æ–±—ã—á–Ω–æ —ç—Ç–æ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–æ –≤—Å–µ—Ö –¥–∏—Å—Ç—Ä–∏–±—É—Ç–∏–≤–∞—Ö).

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

* `zbx_py_cputemp.py` ‚Äî –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞.
* `template_cputemp.yaml` ‚Äî –®–∞–±–ª–æ–Ω Zabbix (Triggers, Items, Graphs).
* `README_RU.md` ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.
